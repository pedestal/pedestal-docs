<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>io.pedestal.interceptor.helpers documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Pedestal.interceptor</span> <span class="project-version">0.5.7</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pedestal</span></div></div></li><li class="depth-3"><a href="io.pedestal.interceptor.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interceptor</span></div></a></li><li class="depth-4 branch"><a href="io.pedestal.interceptor.chain.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>chain</span></div></a></li><li class="depth-4 branch"><a href="io.pedestal.interceptor.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-4 branch current"><a href="io.pedestal.interceptor.helpers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-4"><a href="io.pedestal.interceptor.trace.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trace</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-after"><div class="inner"><span>after</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-around"><div class="inner"><span>around</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-before"><div class="inner"><span>before</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defafter"><div class="inner"><span>defafter</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defaround"><div class="inner"><span>defaround</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defbefore"><div class="inner"><span>defbefore</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defhandler"><div class="inner"><span>defhandler</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-definterceptor"><div class="inner"><span>definterceptor</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defmiddleware"><div class="inner"><span>defmiddleware</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defon-request"><div class="inner"><span>defon-request</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-defon-response"><div class="inner"><span>defon-response</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-handler"><div class="inner"><span>handler</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-infer-rest-interceptor-function"><div class="inner"><span>infer-rest-interceptor-function</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-middleware"><div class="inner"><span>middleware</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-on-request"><div class="inner"><span>on-request</span></div></a></li><li class="depth-1"><a href="io.pedestal.interceptor.helpers.html#var-on-response"><div class="inner"><span>on-response</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">io.pedestal.interceptor.helpers</h1><div class="doc"><pre class="plaintext">A collection of interceptor helpers.

The usage of the Interceptor API is preferred over the macros
defined in this namespace. Usage of the macro helpers should be
limited to cases where you are porting an existing Pedestal code
base.
 
The helper macros predate the interceptor API and can break AOT
compilation but they are maintained for backwards
compatibility. Refer to
<a href="https://github.com/pedestal/pedestal/issues/308">https://github.com/pedestal/pedestal/issues/308</a> and
<a href="https://github.com/pedestal/pedestal/pull/301">https://github.com/pedestal/pedestal/pull/301</a> for more details about
macro helper issues and the rationale for the Interceptor API.</pre></div><div class="public anchor" id="var-after"><h3>after</h3><div class="usage"><code>(after f)</code><code>(after f &amp; args)</code></div><div class="doc"><pre class="plaintext">Return an interceptor which calls `f` on context during the leave
stage.</pre></div></div><div class="public anchor" id="var-around"><h3>around</h3><div class="usage"><code>(around f1 f2)</code><code>(around n f1 f2)</code></div><div class="doc"><pre class="plaintext">Return an interceptor which calls `f1` on context during the enter
stage, and calls `f2` on context during the leave stage.</pre></div></div><div class="public anchor" id="var-before"><h3>before</h3><div class="usage"><code>(before f)</code><code>(before f &amp; args)</code></div><div class="doc"><pre class="plaintext">Returns an interceptor which calls `f` on context during the enter
stage.</pre></div></div><div class="public anchor" id="var-defafter"><h3>defafter</h3><h4 class="type">macro</h4><div class="usage"><code>(defafter macro-name__14804__auto__ &amp; args__14805__auto__)</code></div><div class="doc"><pre class="plaintext">Defines an after interceptor. The defined function is processed
during the leave stage of interceptor execution. The implicitly
created function will operate on context, and return a value used as
the new context, e.g.:

(defafter check-zotted
  [context]
  (if-not (:zotted context)
    (throw (ex-info "Context was not zotted!"
                    {:context context}))
    context))</pre></div></div><div class="public anchor" id="var-defaround"><h3>defaround</h3><h4 class="type">macro</h4><div class="usage"><code>(defaround n &amp; args)</code></div><div class="doc"><pre class="plaintext">Defines an around interceptor. The definition resembles a multiple
arity function definition, however both fns are 1-arity. The first
fn will be called during the enter stage, the second during the
leave stage, e.g.:

(defaround aroundinterceptor
  ([context] (assoc context :around :entering))
  ([context] (assoc context :around :leaving)))</pre></div></div><div class="public anchor" id="var-defbefore"><h3>defbefore</h3><h4 class="type">macro</h4><div class="usage"><code>(defbefore macro-name__14804__auto__ &amp; args__14805__auto__)</code></div><div class="doc"><pre class="plaintext">Defines a before interceptor. The
defined function performs processing during interceptor execution
during the enter stage. The implicitly created function will operate
on context, and return a value used as the new context, e.g.:

(defbefore flag-zotted
  [context]
  (assoc context :zotted true))</pre></div></div><div class="public anchor" id="var-defhandler"><h3>defhandler</h3><h4 class="type">macro</h4><div class="usage"><code>(defhandler macro-name__14804__auto__ &amp; args__14805__auto__)</code></div><div class="doc"><pre class="plaintext">Defines a handler interceptor. The definition mirrors a ring-style
request handler and is made in terms of a ring style request. The
implicitly created interceptor will extract the request from the
context it receives, pass it to the defined function, and then
associate the return value from the defined function as into
context with the :response key and return context, e.g.:

(defhandler hello-name
  [request]
  (ring.util.response/response
    (str "Hello, " (-&gt; request
                         :params
                         :name))))

This is equivalent to:

(defbefore hello-name
  [context]
  (let [request (:request context)
        response (ring.util.response/response
                   (str "Hello, " (-&gt; request
                                        :params
                                        :name)))]
    (assoc context :response response)))</pre></div></div><div class="public anchor" id="var-definterceptor"><h3>definterceptor</h3><h4 class="type">macro</h4><div class="usage"><code>(definterceptor name &amp; body)</code></div><div class="doc"><pre class="plaintext">Define an instance of an interceptor and store it in a var. An
optional doc string can be provided.
The body can be anything that satisfies the IntoInterceptor protocol.

usage:
  (definterceptor encode-response
     "An interceptor that encodes the response as json"
     (on-response encode-json))

Alternatively, you may also:
  (def encode-response
    "An interceptor that encodes the response as json"
    (on-response encode-json)</pre></div></div><div class="public anchor" id="var-defmiddleware"><h3>defmiddleware</h3><h4 class="type">macro</h4><div class="usage"><code>(defmiddleware n &amp; args)</code></div><div class="doc"><pre class="plaintext">Defines a middleware interceptor. The definition resembles a
multiple arity function definition, however both fns are
1-arity. The first fn will be called during the enter stage with the
value of the :request key in the context, the second during the
leave stage with the response key in the context, e.g.:

(defmiddleware middleware-interceptor
  ([request] (assoc request :middleware :on-request))
  ([response] (assoc response :middleware :on-response)))</pre></div></div><div class="public anchor" id="var-defon-request"><h3>defon-request</h3><h4 class="type">macro</h4><div class="usage"><code>(defon-request macro-name__14804__auto__ &amp; args__14805__auto__)</code></div><div class="doc"><pre class="plaintext">Defines an on-request interceptor. The definition performs
pre-processing on a request during the enter stage of interceptor
execution. The implicitly created interceptor will extract the
request from the context it receives, pass it to the defined
function, and then associate the return value from the defined
function as into context with the :request key and return
context, e.g.:

(defon-request parse-body-as-wibblefish
  [request]
  (assoc request :wibblefish-params
         (wibblefish-parse (:body request))))

This is equivalent to:

(defbefore parse-body-as-wibblefish
  [context]
  (let [request (:request context)
        new-request (assoc request :wibblefish-params
                           (wibblefish-parse (:body request)))]
    (assoc context :request new-request)))</pre></div></div><div class="public anchor" id="var-defon-response"><h3>defon-response</h3><h4 class="type">macro</h4><div class="usage"><code>(defon-response macro-name__14804__auto__ &amp; args__14805__auto__)</code></div><div class="doc"><pre class="plaintext">Defines an on-response interceptor. The definition performs post
processing on a response during the leave stage of interceptor
execution. The implicitly created interceptor will extract the
response from the context it receives, pass it to the defined
function, and then associate the return value from the defined function
into context with the :response key and return context, e.g.:

(defon-response change-body-to-html
  [response]
  (assoc response :body
         (render-to-html (:body response))))

This is equivalent to:

(defafter change-body-to-html
  [context]
  (let [response (:response context)
        new-response (assoc response :body
                            (render-to-html (:body response)))]
    (assoc context :response new-response)))</pre></div></div><div class="public anchor" id="var-handler"><h3>handler</h3><div class="usage"><code>(handler f)</code><code>(handler n f)</code></div><div class="doc"><pre class="plaintext">Returns an interceptor which calls f on the :request value of
context, and assoc's the return value as :response into context during the
enter stage.</pre></div></div><div class="public anchor" id="var-infer-rest-interceptor-function"><h3>infer-rest-interceptor-function</h3><div class="usage"><code>(infer-rest-interceptor-function args)</code></div><div class="doc"><pre class="plaintext">Given list `args`, return the rest of args that would remain after
removing the elements of args that specify the form returned by
infer-first-interceptor-function.</pre></div></div><div class="public anchor" id="var-middleware"><h3>middleware</h3><div class="usage"><code>(middleware f1 f2)</code><code>(middleware n f1 f2)</code></div><div class="doc"><pre class="plaintext">Returns an interceptor which calls `f1` on the :request value of
context during the enter stage, and `f2` on the :response value of
context during the leave stage.</pre></div></div><div class="public anchor" id="var-on-request"><h3>on-request</h3><div class="usage"><code>(on-request f)</code><code>(on-request f &amp; args)</code></div><div class="doc"><pre class="plaintext">Returns an interceptor which updates the :request value of context
with f during the enter stage.</pre></div></div><div class="public anchor" id="var-on-response"><h3>on-response</h3><div class="usage"><code>(on-response f)</code><code>(on-response f &amp; args)</code></div><div class="doc"><pre class="plaintext">Returns an interceptor which updates the :response value of context
with f during the leave stage.</pre></div></div></div></body></html>